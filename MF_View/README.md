# 魔方复原助手 (MF_View)

一个基于OpenCV和QBR的视觉识别魔方复原助手，能够通过摄像头识别魔方状态并提供详细的复原步骤指导。

## 功能特点

- 📷 **实时魔方识别**：使用摄像头实时识别魔方的六个面
- 🧩 **魔方状态可视化**：直观显示各面的颜色状态
- 🔄 **自动生成解法**：使用Kociemba算法生成高效的魔方复原步骤
- 📋 **分步指引**：提供详细的旋转操作指导，中文解释每一步骤
- 🖥️ **友好的用户界面**：基于Tkinter的简洁直观操作界面
- � **颜色校准功能**：支持自定义魔方颜色校准，适应不同光照环境
- 🌐 **多语言支持**：支持中文、英文、德文、西班牙文等多种语言

## 系统要求

- Python 3.6+
- 支持OpenCV的摄像头
- Windows、Linux或macOS系统

## 项目结构

```
MF_View/
├── index.png              # 程序图标
├── MF_GUI.py              # 主界面程序
├── README.md              # 项目说明文档
├── README.py              # 依赖生成脚本
├── requirements.txt       # 项目依赖列表
├── starter.py             # 程序启动器
└── src/                   # 源代码目录
    ├── assets/            # 资源文件
    │   └── arial-unicode-ms.ttf  # 字体文件
    ├── colordetection.py  # 颜色检测模块
    ├── config.py          # 配置管理
    ├── constants.py       # 常量定义
    ├── helpers.py         # 辅助函数
    ├── qbr.py             # QBR核心引擎
    ├── translations/      # 多语言翻译文件
    │   ├── ar.json        # 阿拉伯语
    │   ├── de.json        # 德语
    │   ├── en.json        # 英语
    │   ├── es.json        # 西班牙语
    │   ├── fr.json        # 法语
    │   ├── hu.json        # 匈牙利语
    │   ├── nl.json        # 荷兰语
    │   ├── zh-tw.json     # 繁体中文
    │   └── zh.json        # 简体中文
    └── video.py           # 视频处理模块
```

## 安装说明

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

或者使用pip3：

```bash
pip3 install -r requirements.txt
```

### 2. 运行程序

使用以下命令启动魔方复原助手：

```bash
python starter.py
```

## 使用方法

### QBR内嵌模式使用流程

1. 启动程序后，点击"内嵌使用QBR解魔方"按钮
2. 按照界面提示，按键`c`进入颜色校准模式
3. 在校准模式中，依次展示每个面的中心块，按空格键校准
4. 完成校准后，按`c`键退出校准模式
5. 然后进行魔方面的录入:
   - 按对应的按键(U/R/F/D/L/B)选择要录入的面
   - 按空格键拍摄并记录当前选择的面
   - 重复以上步骤直到录入所有六个面
6. 面的标准定义（参考）:
   - U (Up/上面) - 通常为白色
   - R (Right/右面) - 通常为红色
   - F (Front/前面) - 通常为绿色
   - D (Down/下面) - 通常为黄色
   - L (Left/左面) - 通常为橙色
   - B (Back/后面) - 通常为蓝色
7. 完成所有面的拍摄后，程序会自动生成解法并显示详细步骤

### QBR独立窗口模式使用流程

1. 启动程序后，点击"使用QBR解魔方"按钮
2. 在新窗口中，按`c`键进入颜色校准模式
3. 依次校准各个面的颜色
4. 完成校准后，依次拍摄魔方的六个面
5. 所有面拍摄完成后，系统会自动生成解法并返回主界面显示

## 常见问题

### 版本兼容问题

如果遇到NumPy与SciPy版本不兼容的警告，请确保安装了兼容版本：

```bash
pip install numpy==1.22.4
```

### 摄像头问题

1. 确保摄像头未被其他程序占用
2. 检查光线条件，保证光线充足均匀
3. 对准魔方时保持魔方面平整，并充满屏幕中央的识别框

### 颜色识别问题

1. 如果颜色识别不准确，请使用`c`键进入颜色校准模式重新校准
2. 确保校准和拍摄时环境光线稳定
3. 避免反光或阴影干扰魔方表面

## 技术说明

- 使用OpenCV进行图像处理和魔方面识别
- 采用Kociemba算法计算魔方的最优解法
- 使用Tkinter构建图形用户界面
- 多线程设计保证界面响应性
- 支持多语言国际化
- 自适应颜色检测算法，适应不同光照环境

## 开发说明

项目基于QBR(Qbr - Rubik's cube solver)扩展开发，增加了图形界面和中文支持。主要改进：

1. 重构了界面系统，使用Tkinter提供更友好的GUI
2. 增强了颜色识别的稳定性
3. 添加了详细的中文步骤解释
4. 改进了多线程处理，提高响应性
5. 增加了更多错误处理和用户提示

## 致谢

- Kociemba算法提供了高效的魔方解法
- OpenCV提供了强大的计算机视觉支持
- QBR项目提供了基础的魔方识别技术
